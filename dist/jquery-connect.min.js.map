{"version":3,"sources":["utils/shallowEqual.js","actions/init.js","actions/rerender.js","actions/sideEffect.js","index.js"],"names":["is","x","y","toString","shallowEqual","objA","objB","keysA","Object","keys","keysB","length","i","prototype","hasOwnProperty","call","getInitAction","renderFunction","mapStateToProps","store","Error","$","window","jQuery","that","$element","bindedMapStateToProps","bind","dispatch","oldProps","undefined","render","forceRender","state","getState","props","data","removeData","jConnect_sideEffects","jConnect_render","subscribe","getRerenderAction","getSideEffectAction","sideEffectCallback","dependencies","sideEffectsCounter","sideEffects","depenencies","callback","fn","connect","arg1","arg2","arg3","callbackToApply","each"],"mappings":"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","file":"jquery-connect.min.js","sourceRoot":"..\\src","sourcesContent":["function is(x, y) {\r\n  if (x === y) {\r\n    return x !== 0 || y !== 0 || 1 / x === 1 / y;\r\n  }\r\n\r\n  if (typeof x === 'function' && typeof y === 'function') {\r\n    return x.toString() === y.toString();\r\n  }\r\n\r\n  return x !== x && y !== y;\r\n}\r\n\r\nexport default function shallowEqual(objA, objB) {\r\n  if (is(objA, objB)) {\r\n    return true;\r\n  }\r\n\r\n  if (typeof objA !== 'object' || objA === null || typeof objB !== 'object' || objB === null) {\r\n    return false;\r\n  }\r\n\r\n  const keysA = Object.keys(objA);\r\n  const keysB = Object.keys(objB);\r\n\r\n  if (keysA.length !== keysB.length) {\r\n    return false;\r\n  }\r\n\r\n  for (let i = 0; i < keysA.length; i++) {\r\n    if (!Object.prototype.hasOwnProperty.call(objB, keysA[i]) || !is(objA[keysA[i]], objB[keysA[i]])) {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  return true;\r\n}\r\n","import shallowEqual from '../utils/shallowEqual';\r\n\r\nexport default function getInitAction(renderFunction, mapStateToProps = null, store = null) {\r\n    if (!mapStateToProps) {\r\n        throw new Error('$.fn.connect: no mapStateToProps provided');\r\n    }\r\n\r\n    if (!store) {\r\n        throw new Error('$.fn.connect: no store provided');\r\n    }\r\n\r\n    const $ = window.jQuery;\r\n\r\n    return function () {\r\n        const that = this;\r\n        const $element = $(that);\r\n        const bindedMapStateToProps = mapStateToProps.bind(that);\r\n\r\n        const dispatch = store.dispatch.bind(store);\r\n        let oldProps = undefined;\r\n\r\n        function render(forceRender = false) {\r\n            const state = store.getState();\r\n            const props = bindedMapStateToProps(state, dispatch);\r\n            const shouldForceRender = forceRender || oldProps === undefined;\r\n            const shouldRender = shouldForceRender || !shallowEqual(props, oldProps);\r\n\r\n            if (!shouldRender) {\r\n                return;\r\n            }\r\n\r\n            oldProps = props === undefined ? null : props;\r\n\r\n            $element.data('jConnect_sideEffectsCounter', 0);\r\n            renderFunction.bind($element)(props);\r\n            $element.removeData('jConnect_sideEffectsCounter');\r\n        }\r\n\r\n        $element.data({\r\n            jConnect_sideEffects: [],\r\n            jConnect_render: render,\r\n        });\r\n\r\n        store.subscribe(render);\r\n        return render();\r\n    };\r\n}\r\n","export default function getRerenderAction() {\r\n    const $ = window.jQuery;\r\n    \r\n    return function() {\r\n        $(this).data('jConnect_render')(true);\r\n    };\r\n};","import shallowEqual from '../utils/shallowEqual';\r\n\r\nexport default function getSideEffectAction(sideEffectCallback, dependencies) {\r\n    const $ = window.jQuery;\r\n    \r\n    return function() {\r\n        const $element = $(this);\r\n        const sideEffectsCounter = $element.data('jConnect_sideEffectsCounter');\r\n\r\n        if (sideEffectsCounter === undefined) {\r\n            throw new Error('$.fn.connect: cannot call \"sideEffect\" outside $.fn.connect lifeccycle.');\r\n        }\r\n\r\n        const sideEffects = $element.data('jConnect_sideEffects');\r\n\r\n        if (!(sideEffectsCounter in sideEffects) || !shallowEqual(sideEffects[sideEffectsCounter].depenencies, dependencies)) {\r\n            if (sideEffects[sideEffectsCounter] && sideEffects[sideEffectsCounter].callback) {\r\n                sideEffects[sideEffectsCounter].callback.bind(this)();\r\n            }\r\n\r\n            sideEffects[sideEffectsCounter] = {\r\n                dependencies: dependencies,\r\n                callback: sideEffectCallback.bind(this)(),\r\n            };\r\n        }\r\n\r\n        $element.data('jConnect_sideEffectsCounter', sideEffectsCounter + 1);\r\n    };\r\n}","import getInitAction from './actions/init';\r\nimport getRerenderAction from './actions/rerender';\r\nimport getSideEffectAction from './actions/sideEffect';\r\n\r\nwindow.jQuery.fn.connect = function(arg1, arg2, arg3) {\r\n    let callbackToApply;\r\n\r\n    if (typeof arg1 === 'function') {\r\n        callbackToApply = getInitAction(arg1, arg2, arg3);\r\n    } else {\r\n        switch (arg1) {\r\n            case 'rerender':\r\n                callbackToApply = getRerenderAction();\r\n            break;\r\n\r\n            case 'sideEffect':\r\n                callbackToApply = getSideEffectAction(arg2, arg3);\r\n            break;\r\n\r\n            default:\r\n                throw new Error(`$.fn.connect: do not recognize action \"${arg1}\"`);\r\n            break;\r\n        }\r\n    }\r\n\r\n    return this.each(callbackToApply);\r\n};\r\n"]}